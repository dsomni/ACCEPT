<!DOCTYPE html>
<html>
    <head>
        <title>Панель управления</title>

        <meta charset="utf-8">
        <meta name="viewport"
              content="width=device-width, initial-scale=1.0,
              maximum-scale=1.0, minimum-scale=1.0,
              user-scalable=no, minimal-ui">
        <meta name="full-screen" content="yes">
        </head>
    <body>
        <main>
            <h1 class="h1">Панель управления</h1>

            <form action='/service/control/panel'  method="POST">
                <div class="taskAdderForm" id="configform">
                </div>
            </form>
        </main>
    </body>
    <script type = text/javascript>
        document.getElementsByTagName('body')[0].removeChild(document.getElementsByTagName('header')[0]);
        document.getElementsByTagName('body')[0].removeChild(document.getElementsByTagName('button')[0]);
    </script>
    <script>
        function construct(obj, depth){
            let txt = "";
            for (key in obj){
                txt+=`<span class="depth${depth}">${key}</span>\n`;
                if (obj[key] instanceof Object && !(obj[key] instanceof Array)) {
                    txt += construct(obj[key], depth+1)
                }else{
                    txt+= `<textarea style="margin-left:${15*depth-1}px" id="${key}" name = "${key}" cols=4 placeholder="">${obj[key]}</textarea>`
                }
            }
            return txt;
        }
        fetch("/api/get/configs").then(response => response.json()).then(response => {
            text =  construct(response.config, 1);
            document.getElementById("configform").innerHTML = text + "\n<br></button><button>Сохранить</button>";
        }).catch(err => console.log(err));
    </script>

</html>